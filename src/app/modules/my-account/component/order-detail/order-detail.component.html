<nav class="navbar navbar-light bg-white d-flex justify-content-between">
  <span class="navbar-brand">
    Order {{(order$ | async)?.Name}}
  </span>
  <button class="btn btn-outline-primary">Reorder</button>
</nav>

<div *ngIf="(order$ | async); else loading">
  <div class="row mt-3">
    <div class="col-12 col-md-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Billing Address</h5>
          {{(order$ | async)?.Apttus_Config2__PrimaryContactId__r?.FirstName}} {{(order$ | async)?.Apttus_Config2__PrimaryContactId__r?.LastName}}
          <apt-address [ngModel]="(order$ | async)" name="billingAddress" [readonly]="true"></apt-address>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Shipping Address</h5>
          {{(order$ | async)?.Apttus_Config2__PrimaryContactId__r?.FirstName}} {{(order$ | async)?.Apttus_Config2__PrimaryContactId__r?.LastName}}
          <apt-address [ngModel]="(order$ | async)" name="shippingAddress" type="shipping" [readonly]="true"></apt-address>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col-12 col-md-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Payment Information</h5>
          <dl>
            <dt>Payment Type:</dt>
            <dd>Purchase Order</dd>

            <dt>PO Number:</dt>
            <dd>{{(order$ | async)?.Apttus_Config2__PONumber__c}}</dd>

            <dt>Total Amount:</dt>
            <dd>{{(order$ | async)?.Total_Order_Amount__c | localCurrency | async}}
          </dl>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Order Summary</h5>
          <dl>
            <dt>Order Id:</dt>
            <dd>{{(order$ | async)?.Name}}</dd>

            <dt>Order Date:</dt>
            <dd>{{(order$ | async)?.CreatedDate | date:'short'}}</dd>

            <dt>Order Status:</dt>
            <dd>{{(order$ | async)?.Apttus_Config2__Status__c}}</dd>
          </dl>
        </div>
      </div>
    </div>
  </div>

  <div class="row mt-3">
    <div class="col-12">
      <div class="card p-0">
        <table class="table">
          <thead>
            <tr>
              <th scope="col">Items</th>
              <th scope="col">Your Price</th>
              <th scope="col" class="text-center">Quantity</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let lineItem of (order$ | async)?.Apttus_Config2__OrderLineItems__r?.records">
              <th scope="row">
                <div class="media align-items-stretch">
                  <img class="mr-3" [src]="lineItem.Apttus_Config2__ProductId__r.Apttus_Config2__IconId__c | image" width="75" height="60" alt="Generic placeholder image">
                  <div class="media-body d-flex flex-column justify-content-between">
                    <div>
                      <h6 class="m-0">{{lineItem.Apttus_Config2__ProductId__r?.Name}}</h6>
                      <small><strong>Product Code:</strong>&nbsp;{{lineItem.Apttus_Config2__ProductId__r.ProductCode}}</small>
                    </div>
                  </div>
                </div>
              </th>
              <td>{{(lineItem | CartItemPricePipe | async)?.totalPrice$ | async}}</td>
              <td class="text-center">
                <span class="badge badge-light p-3 text-muted">{{lineItem.Apttus_Config2__Quantity__c}}</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>  
    </div>
  </div>

</div>

<ng-template #loading>
  <div class="d-flex justify-content-center py-5">
    <apt-md-spinner></apt-md-spinner>
  </div>
</ng-template>